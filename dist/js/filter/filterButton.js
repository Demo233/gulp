"use strict";var isFirstClick=!0,orbitToolsButton=null,currentActiveButton=null;function createGroupButton(){var t=BimBdip.view.getToolbar(!0).getControl(av.TOOLBAR.BASEMODELSHOWSID);(orbitToolsButton=new Autodesk.Viewing.UI.ComboButton("toolbar-pengpeng")).setToolTip("过滤收藏夹"),orbitToolsButton.setIcon("fl-favorite"),orbitToolsButton.setDisplay("block"),createOrbitSubmenu(orbitToolsButton),t.addControl(orbitToolsButton),t.orbittoolsbutton=orbitToolsButton,t.returnToDefault=function(){}}var createNavToggler=function(t,e,i){return function(){var t=e.getState();t===Autodesk.Viewing.UI.Button.State.INACTIVE?e.setState(Autodesk.Viewing.UI.Button.State.ACTIVE):t===Autodesk.Viewing.UI.Button.State.ACTIVE&&e.setState(Autodesk.Viewing.UI.Button.State.INACTIVE)}};function navActionDisplayMode(t){return BimBdip.view.navigation.isActionEnabled(t)?"block":"none"}function createOrbitSubmenu(t){var e=BimBdip.view.getToolbar(!0).getControl(av.TOOLBAR.BASEMODELSHOWSID),i=new Autodesk.Viewing.UI.Button("btn_filter1");i.setToolTip("过滤器"),i.setIcon("filtrations"),i.onClick=function(){isFirstClick=!1,orbitToolsButton.setToolTip("过滤器"),orbitToolsButton.setIcon("filtrations"),$("#toolbar-pengpeng").addClass("active"),currentActiveButton="filtrations",activate("filter")},t.addControl(i),e.freeorbitbutton=i;var o=new Autodesk.Viewing.UI.Button("btn_filter2");o.setToolTip("收藏夹"),o.setIcon("favorite"),o.onClick=function(){isFirstClick=!1,orbitToolsButton.setToolTip("收藏夹"),orbitToolsButton.setIcon("favorite"),$("#toolbar-pengpeng").addClass("active"),currentActiveButton="favorite",activate("collection")},t.addControl(o),e.orbitbutton=o,t.onClick=function(){if(isFirstClick)$("#toolbar-pengpengSubMenu").hasClass("adsk-hidden")?$("#toolbar-pengpengSubMenu").removeClass("adsk-hidden"):$("#toolbar-pengpengSubMenu").addClass("adsk-hidden");else if($("#toolbar-pengpeng").hasClass("active"))$("#toolbar-pengpeng").removeClass("active");else{switch(currentActiveButton){case"filtrations":activate("filter");break;case"favorite":activate("collection")}$("#toolbar-pengpeng").addClass("active")}}}function activate(t){return bimOriginFilter.beVisible=!1,"filter"===t?0==BimBdip.view.getSelection().length?Dialog.alert("请先选择需要过滤的模型构件！",function(){$(bimOriginFilter.btnFilterAndCollect).removeClass("active"),$(bimOriginFilter.btnFilterAndCollect).addClass("inactive")}):($(".sidebar_advanced").hide(),$("#advanced_btn").addClass("top_img"),$("#advanced_btn").removeClass("bottom_img"),bimOriginFilter.doStartFilter(),$("#tabs li").eq(0).trigger("click")):"collection"===t&&($(".sidebar_advanced").hide(),$("#advanced_btn").addClass("top_img"),$("#advanced_btn").removeClass("bottom_img"),bimOriginFilter.doStartFilter(),bimOriginFilter.loadTreeOther(),$("#tabs li").eq(1).trigger("click"),$("#tabs li").eq(0)[0].addEventListener("click",handleFilterClick,!1)),this.activeStatus=!0}function deactivate(){return this.activeStatus&&(BimBdip.view.setActiveNavigationTool(),this.activeStatus=!1),!0}function handleFilterClick(){if(0==BimBdip.view.getSelection().length){if(2<Dialog.length)return;Dialog.alert("请先选择需要过滤的模型构件！"),$("#tabs li").eq(1).trigger("click")}else bimOriginFilter.setVisibleForFilter(!1),bimOriginFilter.doStartFilter()}window.onload=function(){$("#toolbar-pengpengarrow")[0].addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),isFirstClick||($("#toolbar-pengpengSubMenu").hasClass("adsk-hidden")?$("#toolbar-pengpengSubMenu").removeClass("adsk-hidden"):$("#toolbar-pengpengSubMenu").addClass("adsk-hidden"))},!1)};